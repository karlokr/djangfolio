{% load static %}

<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{{ site_config.full_name }}{% endblock %}</title>
    {% if site_config.favicon %}
        <link rel="shortcut icon" type="image/png" href="{{ site_config.favicon.url }}"/>
    {% endif %}
    <link href="https://fonts.googleapis.com/css?family=Hind:300,400,500,600,700" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" type="text/css" href="{% static 'bootstrap-4/dist/css/bootstrap.min.css' %}">
    <link href="{% static 'home/css/style.css' %}" rel="stylesheet">
    <link href="{% static 'blog/css/style.css' %}" rel="stylesheet">
    <link href="{% static 'projects/css/style.css' %}" rel="stylesheet">
    {% block extra_css %}{% endblock %}
    <script type="text/javascript" src="{% static 'jquery-3/dist/jquery.min.js' %}"></script> 
    <script type="text/javascript" src="{% static 'bootstrap-4/dist/js/bootstrap.bundle.min.js' %}"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>

<body {% block body_attrs %}{% endblock %}>

<!-- Loading Circle - only loads once on initial page load -->
<div id="preloader" style="background: rgba(255, 255, 255, 1.0)">
    <div id="status">
        <div class="status-mes"></div>
    </div>
</div>

{% include 'home/navbar.html' with active_page=active_page %}

<div id="main-content" {% block content_attrs %}{% endblock %}>
    {% block content %}
    {% endblock %}
</div>

{% block extra_js %}{% endblock %}

<script>
    function updateActiveNavLink() {
        const path = window.location.pathname;
        const navItems = document.querySelectorAll('.navbar-nav .nav-item');
        
        navItems.forEach(function(item) {
            item.classList.remove('active');
        });
        
        navItems.forEach(function(item) {
            const link = item.querySelector('.nav-link');
            if (link) {
                const href = link.getAttribute('href');
                // Check for exact match on home, or path starts with for others
                if (path === '/' && href === '/') {
                    item.classList.add('active');
                } else if (path.startsWith('/projects') && href.includes('/projects')) {
                    item.classList.add('active');
                } else if (path.startsWith('/blog') && href.includes('/blog')) {
                    item.classList.add('active');
                }
            }
        });
    }
    
    // Run on page load
    document.addEventListener('DOMContentLoaded', updateActiveNavLink);
    
    // Run after HTMX swaps content
    document.body.addEventListener('htmx:afterSwap', updateActiveNavLink);
    document.body.addEventListener('htmx:pushedIntoHistory', updateActiveNavLink);
    
    // Hide preloader on page load
    $(document).ready(function() {
        $('#preloader').delay(700).fadeOut(700);
    });
</script>

</body>

</html>
