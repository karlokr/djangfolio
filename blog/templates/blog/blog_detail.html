{% extends 'base_layout.html' %}
{% load static %}

{% block title %}{{ post.title }} - {{ site_config.full_name }}{% endblock %}

{% block extra_css %}
<!-- KaTeX for LaTeX math rendering -->
<link rel="stylesheet" href="{% static 'katex/dist/katex.min.css' %}">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="article">
<meta property="og:url" content="{{ request.build_absolute_uri }}">
<meta property="og:title" content="{{ post.title }}">
<meta property="og:description" content="{{ post.excerpt }}">
{% if post.featured_image %}
<meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ post.featured_image.url }}">
<meta property="og:image:alt" content="{{ post.featured_image_caption|default:post.title }}">
{% elif site_config.favicon %}
<meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ site_config.favicon.url }}">
<meta property="og:image:alt" content="{{ site_config.full_name }}">
{% endif %}

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="{{ request.build_absolute_uri }}">
<meta property="twitter:title" content="{{ post.title }}">
<meta property="twitter:description" content="{{ post.excerpt }}">
{% if post.featured_image %}
<meta property="twitter:image" content="{{ request.scheme }}://{{ request.get_host }}{{ post.featured_image.url }}">
<meta property="twitter:image:alt" content="{{ post.featured_image_caption|default:post.title }}">
{% elif site_config.favicon %}
<meta property="twitter:image" content="{{ request.scheme }}://{{ request.get_host }}{{ site_config.favicon.url }}">
<meta property="twitter:image:alt" content="{{ site_config.full_name }}">
{% endif %}

<!-- LinkedIn -->
<meta property="og:site_name" content="{{ site_config.full_name }}">
<meta property="article:published_time" content="{{ post.created_date|date:'c' }}">
<meta property="article:author" content="{{ post.author }}">
{% endblock %}

{% block content %}
{% include 'blog/blog_detail_partial.html' %}
{% endblock %}

{% block extra_js %}
<script src="{% static 'katex/dist/katex.min.js' %}"></script>
<script src="{% static 'katex/dist/contrib/auto-render.min.js' %}"></script>
<script>
    function renderMath() {
        const el = document.querySelector('.blog-content');
        if (el) {
            renderMathInElement(el, {
                delimiters: [
                    {left: '\\(', right: '\\)', display: false},
                    {left: '\\[', right: '\\]', display: true}
                ],
                throwOnError: false
            });
        }
    }
    document.addEventListener('DOMContentLoaded', renderMath);
</script>
{% endblock %}
